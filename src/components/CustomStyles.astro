---
// 'DM Sans'
// Nunito
// Dosis
// Outfit
// Roboto
// Literata
// 'IBM Plex Sans'
// Karla
// Poppins
// 'Fira Sans'
// 'Libre Franklin'
// Inconsolata
// Raleway
// Oswald
// 'Space Grotesk'
// Urbanist
---

<!-- Preload only critical fonts used on initial page load -->
<link rel="preload" href="/fonts/TogetherAssessments-Regular.woff2" as="font" type="font/woff2" crossorigin />
<link rel="preload" href="/fonts/SylexiadSansMedium.woff2" as="font" type="font/woff2" crossorigin />
<!-- OpenDyslexic and Fast Syldexia are deferred - only loaded when accessibility panel opens -->
<!-- This prevents 336KB of non-critical fonts from blocking initial render -->

<!-- Critical font loading: Inject secondary fonts before first paint if user has them saved -->
<!-- This eliminates FOUT on page load for returning users with secondary font preferences -->
<!-- Zero impact on Lighthouse (tests as first-time visitor with no localStorage) -->
<script is:inline>
  (function () {
    try {
      const prefs = localStorage.getItem('accessibility-preferences');
      if (!prefs) return;

      const settings = JSON.parse(prefs);
      const isDeferredFont = settings.font === 'opendyslexic' || settings.font === 'fast';

      if (isDeferredFont) {
        // Inject preload link for high-priority font download
        // This starts downloading the font immediately while the browser is still parsing
        const fontFile =
          settings.font === 'opendyslexic' ? '/fonts/OpenDyslexic3-Regular.woff2' : '/fonts/Fast_Syldexia.woff2';

        const preload = document.createElement('link');
        preload.rel = 'preload';
        preload.as = 'font';
        preload.type = 'font/woff2';
        preload.href = fontFile;
        preload.crossOrigin = 'anonymous';
        document.head.appendChild(preload);

        // Inject @font-face declarations with font-display: block
        // This blocks rendering briefly (~100ms max) while waiting for font to load
        // Eliminates FOUT at the cost of brief FOIT on slow connections
        const style = document.createElement('style');
        style.id = 'accessibility-fonts-styles';
        style.textContent = `
          @font-face {
            font-family: 'OpenDyslexic3';
            src: url('/fonts/OpenDyslexic3-Regular.woff2') format('woff2'),
                 url('/fonts/OpenDyslexic3-Regular.woff') format('woff'),
                 url('/fonts/OpenDyslexic3-Regular.ttf') format('truetype');
            font-weight: 400;
            font-style: normal;
            font-display: block;
          }

          @font-face {
            font-family: 'Fast Syldexia';
            src: url('/fonts/Fast_Syldexia.woff2') format('woff2'),
                 url('/fonts/Fast_Syldexia.woff') format('woff'),
                 url('/fonts/Fast_Syldexia.ttf') format('truetype');
            font-weight: 400;
            font-style: normal;
            font-display: block;
            size-adjust: 120%;
          }
        `;
        document.head.appendChild(style);
      }
    } catch {
      // Silently fail - don't break page if localStorage is unavailable
    }
  })();
</script>

<style is:inline>
  @font-face {
    font-family: 'Together Assessments';
    src:
      url('/fonts/TogetherAssessments-Regular.woff2') format('woff2'),
      url('/fonts/TogetherAssessments-Regular.woff') format('woff'),
      url('/fonts/TogetherAssessments-Regular.ttf') format('truetype');
    font-weight: 400;
    font-style: normal;
    font-display: block;
    size-adjust: 115%;
  }

  @font-face {
    font-family: 'Sylexiad Sans Medium';
    src:
      url('/fonts/SylexiadSansMedium.woff2') format('woff2'),
      url('/fonts/SylexiadSansMedium.woff') format('woff'),
      url('/fonts/SylexiadSansMedium.ttf') format('truetype');
    font-weight: 500;
    font-style: normal;
    font-display: block;
    size-adjust: 120%;
  }

  /* OpenDyslexic and Fast Syldexia @font-face declarations are dynamically injected:
     - On initial page load: Critical script above injects fonts if saved in localStorage (prevents FOUT)
     - On panel open: loadAccessibilityFonts() in AccessibilityPanel.astro injects fonts if not already present
     This prevents fonts from loading unnecessarily on initial render (performance optimization). */

  /* Enable OpenType contextual alternates (calt) feature globally
     This is needed for Fast Syldexia letter highlighting to work.
     Safari enables this by default, but Chrome requires explicit activation.
     This setting only affects fonts that have the calt feature. */
  body {
    font-feature-settings: 'calt';
    font-variant-ligatures: contextual;
  }

  /* Font rendering for Together Assessments heading font
     Forces subpixel rendering on desktop to match mobile's detailed appearance.
     Mobile browsers render fonts with more detail/lighter weight, so we disable
     smoothing to preserve the font's designed weight and detail. */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  .font-heading,
  [style*='font-family: var(--aw-font-heading)'] {
    -webkit-font-smoothing: subpixel-antialiased;
    -moz-osx-font-smoothing: unset;
    text-rendering: optimizeLegibility;
    font-weight: 350 !important;
  }

  :root {
    --aw-font-sans: 'Sylexiad Sans Medium', ui-sans-serif, system-ui, sans-serif;
    --aw-font-serif: 'Sylexiad Sans Medium', ui-serif, Georgia, serif;
    --aw-font-heading: 'Together Assessments', ui-sans-serif, system-ui, sans-serif;

    --aw-color-primary: rgb(78 35 95);
    --aw-color-primary-dark: rgb(62 28 76);
    --aw-color-secondary: rgb(65 28 80);
    --aw-color-accent: rgb(29 121 99);
    --aw-color-accent-dark: rgb(23 97 79);

    --aw-color-text-heading: rgb(0 0 0);
    --aw-color-text-default: rgb(16 16 16);
    --aw-color-text-muted: rgb(16 16 16 / 66%);
    --aw-color-bg-page: rgb(255 255 255);

    --aw-color-bg-page-dark: rgb(18 16 20);

    ::selection {
      background-color: lavender;
    }
  }

  .dark {
    --aw-font-sans: 'Sylexiad Sans Medium', ui-sans-serif, system-ui, sans-serif;
    --aw-font-serif: 'Sylexiad Sans Medium', ui-serif, Georgia, serif;
    --aw-font-heading: 'Together Assessments', ui-sans-serif, system-ui, sans-serif;

    --aw-color-primary: rgb(78 35 95);
    --aw-color-primary-dark: rgb(62 28 76);
    --aw-color-secondary: rgb(65 28 80);
    --aw-color-accent: rgb(29 121 99);
    --aw-color-accent-dark: rgb(23 97 79);

    --aw-color-text-heading: rgb(247, 248, 248);
    --aw-color-text-default: rgb(229 236 246);
    --aw-color-text-muted: rgb(229 236 246 / 66%);
    --aw-color-bg-page: rgb(18 16 20);

    ::selection {
      background-color: black;
      color: snow;
    }
  }

  /* Dark mode hyperlink styling - match text colour with underline for accessibility */
  /* Exclude buttons to preserve their intended colours (WCAG contrast compliance) */
  .dark a:not(.btn):not(.btn-primary):not(.btn-secondary):not(.btn-tertiary) {
    color: var(--aw-color-text-default) !important;
    font-weight: 700;
    text-decoration: underline !important;
  }

  .dark a:not(.btn):not(.btn-primary):not(.btn-secondary):not(.btn-tertiary):hover {
    color: var(--aw-color-text-default) !important;
    text-decoration: none !important;
  }

  /* Light mode prose link styling - ensure consistent underline behavior */
  .prose a {
    text-decoration: underline;
  }

  .prose a:hover {
    text-decoration: none;
  }

  /* Text Size Scaling
     Applied to body content only, not UI components.
     Uses CSS custom property for scale factor. */

  :root {
    --aw-text-size-scale: 1; /* Default: 100% (base) */
  }

  /* Text size classes applied to <body> */
  body.text-size-xs {
    --aw-text-size-scale: 0.875; /* 14px equivalent */
  }

  body.text-size-sm {
    --aw-text-size-scale: 0.9375; /* 15px equivalent */
  }

  body.text-size-base {
    --aw-text-size-scale: 1; /* 16px equivalent (default) */
  }

  body.text-size-lg {
    --aw-text-size-scale: 1.125; /* 18px equivalent */
  }

  body.text-size-xl {
    --aw-text-size-scale: 1.25; /* 20px equivalent */
  }

  /* Apply scale to content text only */
  /* Target prose content, paragraphs, lists, tables, spans, text-containing divs, and accessibility panel */
  .prose,
  .prose p,
  .prose li,
  .prose td,
  .prose th,
  article p,
  article li,
  article td,
  article th,
  main p:not(.accessibility-size-label):not([class*='btn']),
  main li,
  main blockquote,
  main table td,
  main table th,
  main span:not([class*='btn']),
  main div:not([class*='btn']):not(.flex):not(.grid):not([class*='gap']) > span,
  main div:not([class*='btn']) > span,
  .accessibility-panel p,
  .accessibility-panel span:not(.accessibility-size-btn span):not([class*='slider']),
  .accessibility-panel label {
    font-size: calc(1rem * var(--aw-text-size-scale));
  }

  /* Scale headings proportionally but maintain hierarchy */
  .prose h1,
  article h1,
  main h1 {
    font-size: calc(2.25rem * var(--aw-text-size-scale));
  }

  .prose h2,
  article h2,
  main h2,
  .accessibility-panel h2 {
    font-size: calc(1.875rem * var(--aw-text-size-scale));
  }

  .prose h3,
  article h3,
  main h3,
  .accessibility-panel h3 {
    font-size: calc(1.5rem * var(--aw-text-size-scale));
  }

  .prose h4,
  article h4,
  main h4 {
    font-size: calc(1.25rem * var(--aw-text-size-scale));
  }

  .prose h5,
  article h5,
  main h5 {
    font-size: calc(1.125rem * var(--aw-text-size-scale));
  }

  .prose h6,
  article h6,
  main h6 {
    font-size: calc(1rem * var(--aw-text-size-scale));
  }

  /* Ensure line-height stays readable at all sizes */
  .prose,
  article,
  main {
    line-height: calc(1.6 * var(--aw-text-size-scale, 1));
  }

  /* Word wrapping safety for long words */
  .prose,
  article,
  main {
    word-wrap: break-word;
    overflow-wrap: break-word;
  }

  /* Line Height Scaling
     Applied to body text only, not UI components or headings.
     Uses CSS custom property for line height scale factor.
     WCAG 2.1 SC 1.4.12 recommends minimum 1.5 for body text. */

  :root {
    --aw-line-height-scale: 1.5; /* Default: Normal (WCAG recommended) */
  }

  /* Line height classes applied to <body> */
  body.line-height-compact {
    --aw-line-height-scale: 1.2; /* Tighter spacing */
  }

  body.line-height-normal {
    --aw-line-height-scale: 1.5; /* WCAG recommended */
  }

  body.line-height-relaxed {
    --aw-line-height-scale: 2; /* Wider spacing */
  }

  /* Apply line height to body text elements only */
  body,
  p,
  li,
  dd,
  blockquote,
  td,
  th,
  .prose,
  .prose p,
  .prose li,
  .prose dd,
  .prose blockquote,
  .prose td,
  .prose th,
  article p,
  article li,
  article dd,
  article blockquote,
  article td,
  article th,
  main p,
  main li,
  main dd,
  main blockquote,
  main td,
  main th {
    line-height: var(--aw-line-height-scale);
  }

  /* Exclude UI elements from line height scaling - they need fixed spacing */
  button,
  .btn,
  input,
  select,
  textarea,
  nav,
  nav *,
  header,
  header *,
  footer,
  footer *,
  .accessibility-panel,
  .accessibility-panel *,
  .card-title,
  [role='navigation'],
  [role='navigation'] * {
    line-height: 1.5; /* Fixed line height for UI components */
  }

  /* Headings use separate fixed line height for visual hierarchy */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  .prose h1,
  .prose h2,
  .prose h3,
  .prose h4,
  .prose h5,
  .prose h6,
  article h1,
  article h2,
  article h3,
  article h4,
  article h5,
  article h6,
  main h1,
  main h2,
  main h3,
  main h4,
  main h5,
  main h6 {
    line-height: 1.2; /* Fixed for headings */
  }
</style>
